{"ast":null,"code":"import _toConsumableArray from\"D:\\\\minnicreations\\\\ecommerce-front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"D:\\\\minnicreations\\\\ecommerce-front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"D:\\\\minnicreations\\\\ecommerce-front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import Layout from\"./Layout\";import Card from\"./Card\";import{getCategories,getFilteredProducts}from\"./apiCore\";import RadioBox from\"./RadioBox\";import{prices}from\"./fixedPrices\";import Checkbox from\"./Checkbox\";var Shop=function Shop(){var _useState=useState({filters:{category:[],price:[]}}),_useState2=_slicedToArray(_useState,2),myFilters=_useState2[0],setMyFilters=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),categories=_useState4[0],setCategories=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];var _useState7=useState(6),_useState8=_slicedToArray(_useState7,2),limit=_useState8[0],setLimit=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),skip=_useState10[0],setSkip=_useState10[1];var _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),size=_useState12[0],setSize=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),filteredResults=_useState14[0],setFilteredResults=_useState14[1];var init=function init(){getCategories().then(function(data){if(data.error){setError(data.error);}else{setCategories(data);}});};useEffect(function(){init();loadFilteredResults(skip,limit,myFilters.filters);},[]);var _handleFilters=function handleFilters(filters,filterBy){// console.log(\"SHOP\", filters, filterBy);\nvar newFilters=_objectSpread({},myFilters);newFilters.filters[filterBy]=filters;if(filterBy===\"price\"){var priceValues=handlePrice(filters);newFilters.filters[filterBy]=priceValues;}loadFilteredResults(myFilters.filters);setMyFilters(newFilters);};var loadFilteredResults=function loadFilteredResults(newFilters){// console.log(newFilters);\ngetFilteredProducts(skip,limit,newFilters).then(function(data){if(data.error){setError(data.error);}else{setFilteredResults(data.data);setSize(data.size);setSkip(0);}});};var loadMore=function loadMore(){var toSkip=skip+limit;// console.log(newFilters);\ngetFilteredProducts(toSkip,limit,myFilters.filters).then(function(data){if(data.error){setError(data.error);}else{setFilteredResults([].concat(_toConsumableArray(filteredResults),_toConsumableArray(data.data)));setSize(data.size);setSkip(toSkip);}});};var loadMoreButton=function loadMoreButton(){return size>0&&size>=limit&&React.createElement(\"button\",{onClick:loadMore,className:\"btn btn-warning mb-5\"},\"Load more\");};var handlePrice=function handlePrice(value){var data=prices;var array=[];for(var key in data){if(data[key]._id===parseInt(value)){array=data[key].array;}}return array;};return React.createElement(Layout,{title:\"Shop Page\",description:\"Search and find books of your choice\",className:\"container-fluid\"},React.createElement(\"div\",{className:\"row\"},React.createElement(\"div\",{className:\"col-4\"},React.createElement(\"h4\",null,\"Filter by categories\"),React.createElement(\"ul\",null,React.createElement(Checkbox,{categories:categories,handleFilters:function handleFilters(filters){return _handleFilters(filters,\"category\");}})),React.createElement(\"h4\",null,\"Filter by price range\"),React.createElement(\"div\",null,React.createElement(RadioBox,{prices:prices,handleFilters:function handleFilters(filters){return _handleFilters(filters,\"price\");}}))),React.createElement(\"div\",{className:\"col-8\"},React.createElement(\"h2\",{className:\"mb-4\"},\"Products\"),React.createElement(\"div\",{className:\"row\"},filteredResults.map(function(product,i){return React.createElement(\"div\",{key:i,className:\"col-4 mb-3\"},React.createElement(Card,{product:product}));})),React.createElement(\"hr\",null),loadMoreButton())));};export default Shop;","map":{"version":3,"sources":["D:/minnicreations/ecommerce-front/src/core/Shop.js"],"names":["React","useState","useEffect","Layout","Card","getCategories","getFilteredProducts","RadioBox","prices","Checkbox","Shop","filters","category","price","myFilters","setMyFilters","categories","setCategories","error","setError","limit","setLimit","skip","setSkip","size","setSize","filteredResults","setFilteredResults","init","then","data","loadFilteredResults","handleFilters","filterBy","newFilters","priceValues","handlePrice","loadMore","toSkip","loadMoreButton","value","array","key","_id","parseInt","map","product","i"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport Layout from \"./Layout\";\r\nimport Card from \"./Card\";\r\nimport { getCategories, getFilteredProducts } from \"./apiCore\";\r\nimport RadioBox from \"./RadioBox\";\r\nimport { prices } from \"./fixedPrices\";\r\nimport Checkbox from \"./Checkbox\";\r\nconst Shop = () => {\r\n    const [myFilters, setMyFilters] = useState({\r\n        filters: { category: [], price: [] }\r\n    });\r\n    const [categories, setCategories] = useState([]);\r\n    const [error, setError] = useState(false);\r\n    const [limit, setLimit] = useState(6);\r\n    const [skip, setSkip] = useState(0);\r\n    const [size, setSize] = useState(0);\r\n    const [filteredResults, setFilteredResults] = useState([]);\r\n   \r\n    const init = () => {\r\n        getCategories().then(data => {\r\n            if (data.error) {\r\n                setError(data.error);\r\n            } else {\r\n                setCategories(data);\r\n            }\r\n        }); \r\n    }; \r\n    \r\n    useEffect(() => {\r\n        init();\r\n        loadFilteredResults(skip, limit, myFilters.filters);\r\n    }, []);\r\n\r\n    const handleFilters = (filters, filterBy) => {\r\n        // console.log(\"SHOP\", filters, filterBy);\r\n        const newFilters = { ...myFilters };\r\n        newFilters.filters[filterBy] = filters;\r\n\r\n        if (filterBy === \"price\") {\r\n            let priceValues = handlePrice(filters);\r\n            newFilters.filters[filterBy] = priceValues;\r\n        }\r\n        loadFilteredResults(myFilters.filters);\r\n        setMyFilters(newFilters);\r\n    };\r\n\r\n    const loadFilteredResults = newFilters => {\r\n        // console.log(newFilters);\r\n        getFilteredProducts(skip, limit, newFilters).then(data => {\r\n            if (data.error) {\r\n                setError(data.error);\r\n            } else {\r\n                setFilteredResults(data.data);\r\n                setSize(data.size);\r\n                setSkip(0);\r\n            }\r\n        });\r\n    };\r\n\r\n    const loadMore = () => {\r\n        let toSkip = skip + limit;\r\n        // console.log(newFilters);\r\n        getFilteredProducts(toSkip, limit, myFilters.filters).then(data => {\r\n            if (data.error) {\r\n                setError(data.error);\r\n            } else {\r\n                setFilteredResults([...filteredResults, ...data.data]);\r\n                setSize(data.size);\r\n                setSkip(toSkip);\r\n            }\r\n        });\r\n    };\r\n\r\n const loadMoreButton = () => {\r\n        return (\r\n            size > 0 &&\r\n            size >= limit && (\r\n                <button onClick={loadMore} className=\"btn btn-warning mb-5\">\r\n                    Load more\r\n                </button>\r\n            )\r\n        );\r\n    };\r\n\r\n    const handlePrice = value => {\r\n        const data = prices;\r\n        let array = [];\r\n\r\n        for (let key in data) {\r\n            if (data[key]._id === parseInt(value)) {\r\n                array = data[key].array;\r\n            }\r\n        }\r\n        return array;\r\n    };\r\n\r\n\r\n    return (\r\n        <Layout\r\n            title=\"Shop Page\"\r\n            description=\"Search and find books of your choice\"\r\n            className=\"container-fluid\"\r\n        >\r\n            <div className=\"row\">\r\n                <div className=\"col-4\">\r\n                    <h4>Filter by categories</h4>\r\n                    <ul>\r\n                        <Checkbox\r\n                            categories={categories}\r\n                            handleFilters={filters =>\r\n                            handleFilters(filters, \"category\")\r\n                            }\r\n                        />\r\n                    </ul>\r\n\r\n                    <h4>Filter by price range</h4>\r\n                    <div>\r\n                        <RadioBox\r\n                            prices={prices}\r\n                            handleFilters={filters =>\r\n                                handleFilters(filters, \"price\")\r\n                            }\r\n                        />\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"col-8\">\r\n                    <h2 className=\"mb-4\">Products</h2>\r\n                    <div className=\"row\">\r\n                        {filteredResults.map((product, i) => (\r\n                            <div key={i} className=\"col-4 mb-3\">\r\n                            <Card product={product} />\r\n                        </div>\r\n                        ))}\r\n                    </div>\r\n                    <hr />\r\n                    {loadMoreButton()}\r\n                </div>\r\n            </div>\r\n        </Layout>\r\n    );\r\n};\r\n\r\nexport default Shop;\r\n\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}